@import 'variables';

pre[class*='language-'] {
  @apply my-4 min-h-[2rem] overflow-auto whitespace-pre rounded-md p-2 text-left;
  @apply bg-nestable-neutral text-neutral-900 dark:text-neutral-100;

  *::selection {
    @apply bg-neutral-500 bg-opacity-30;
  }
}

:not(pre) > code[class*='language-'] {
  @apply whitespace-normal rounded-sm px-0.5 py-1.5;
}

.token {
  &.comment,
  &.prolog,
  &.cdata {
    color: var(--mono3);
  }

  &.entity,
  &.doctype,
  &.punctuation,
  &.attr-value > .token.punctuation.attr-equals,
  &.special-attr > .token.attr-value > .token.value.css {
    color: var(--mono1);
  }

  &.url {
    color: var(--hue1);
  }

  &.variable,
  &.operator,
  &.function {
    color: var(--hue2);
  }

  &.keyword {
    color: var(--hue3);
  }

  &.selector,
  &.string,
  &.char,
  &.builtin,
  &.inserted,
  &.regex,
  &.attr-value,
  &.attr-value > .token.punctuation {
    color: var(--hue4);
  }

  &.property,
  &.tag,
  &.symbol,
  &.deleted,
  &.important {
    color: var(--hue5);
  }

  &.attr-name,
  &.class-name,
  &.boolean,
  &.constant,
  &.number,
  &.atrule {
    color: var(--hue6);
  }
}

.language-css .token {
  &.property {
    color: var(--mono1);
  }

  &.function,
  &.url > .token.function {
    color: var(--hue1);
  }

  &.important,
  &.atrule .token.rule {
    color: var(--hue3);
  }

  &.url > .token.string.url {
    color: var(--hue4);
  }

  &.selector {
    color: var(--hue5);
  }
}

.language-javascript .token {
  &.operator {
    color: var(--hue3);
  }

  &.template-string
    > .token.interpolation
    > .token.interpolation-punctuation.punctuation {
    color: var(--hue5_2);
  }
}

.language-json .token {
  &.operator {
    color: var(--mono1);
  }
  &.null.keyword {
    color: var(--hue6);
  }
}

.token {
  &.bold {
    font-weight: bold;
  }

  &.italic,
  &.comment {
    font-style: italic;
  }

  &.entity {
    cursor: help;
  }

  &.namespace {
    opacity: 0.8;
  }

  &.token {
    &.tab:not(:empty):before,
    &.cr:before,
    &.lf:before,
    &.space:before {
      color: var(--mono3);
    }
  }
}

.language-markdown .token {
  &.url,
  &.url > .token.operator,
  &.url-reference.url > .token.string {
    color: var(--mono1);
  }

  &.blockquote.punctuation,
  &.hr.punctuation {
    color: var(--mono3);
    font-style: italic;
  }

  &.url > .token.url,
  &.url-reference.url {
    color: var(--hue1);
  }

  &.url > .token.content {
    color: var(--hue2);
  }

  &.italic .token.content {
    color: var(--hue3);
  }

  &.code-snippet {
    color: var(--hue4);
  }

  &.strike .token.content,
  &.strike .token.punctuation,
  &.list.punctuation,
  &.title.important > .token.punctuation {
    color: var(--hue5);
  }

  &.bold .token.content {
    color: var(--hue6);
  }
}

div.code-toolbar > .toolbar.toolbar > .toolbar-item {
  margin-right: 0.4em;

  > button,
  > a,
  > span {
    @apply bg-neutral-500 bg-opacity-30;
    color: var(--mono2);
    padding: 0.1em 0.4em;
    border-radius: 0.3em;
    &:hover,
    &:focus {
      @apply bg-neutral-500 bg-opacity-30;
      color: var(--mono1);
    }
  }
}

.line-highlight.line-highlight:before,
.line-highlight.line-highlight[data-end] :after {
  @apply rounded-sm bg-neutral-500 bg-opacity-30 px-3 py-1.5 shadow-sm;
  color: var(--mono1);
}

.line-highlight.line-highlight,
pre[id].linkable-line-numbers.linkable-line-numbers
  span.line-numbers-rows
  > span:hover:before {
  @apply bg-neutral-500 bg-opacity-80;
}

.line-numbers.line-numbers .line-numbers-rows,
.command-line .command-line-prompt {
  border-right-color: var(--mono3);
}

.command-line .command-line-prompt > span:before,
.line-numbers .line-numbers-rows > span:before {
  color: var(--mono4);
}

.rainbow-braces .token.token.punctuation {
  &.brace-level-1,
  &.brace-level-5,
  &.brace-level-9 {
    color: var(--hue5);
  }

  &.brace-level-2,
  &.brace-level-6,
  &.brace-level-10 {
    color: var(--hue4);
  }

  &.brace-level-3,
  &.brace-level-7,
  &.brace-level-11 {
    color: var(--hue2);
  }

  &.brace-level-4,
  &.brace-level-8,
  &.brace-level-12 {
    color: var(--hue3);
  }
}

pre.diff-highlight > code .token.token {
  &.deleted:not(.prefix) {
    background-color: hsla(353, 100%, 66%, 0.15);

    &::selection,
    *::selection {
      background-color: hsla(353, 95%, 66%, 0.25);
    }
  }

  &.inserted:not(.prefix) {
    background-color: hsla(137, 100%, 55%, 0.15);

    &::selection,
    *::selection {
      background-color: hsla(135, 73%, 55%, 0.25);
    }
  }
}
