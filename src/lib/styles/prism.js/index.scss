pre[class*='language-'] {
  padding: 0.5rem;
  border-radius: 0.3em;
}

code[class*='language-'],
pre[class*='language-'] {
  background-color: var(--bg-codeblock);
  color: var(--text-color);
  direction: ltr;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  line-height: 1.5;
  tab-size: 2;
  hyphens: none;
  overflow: auto;
  &::-webkit-scrollbar {
    display: none;
  }

  *::selection {
    background-color: var(--bg-selection);
    color: inherit;
  }

  &:empty {
    margin: 1px;
  }
}

:not(pre) > code[class*='language-'] {
  padding: 0.2em 0.3em;
  border-radius: 0.3em;
  white-space: normal;
}

.token {
  &.comment,
  &.prolog,
  &.cdata {
    color: var(--mono3);
  }

  &.entity,
  &.doctype,
  &.punctuation,
  &.attr-value > .token.punctuation.attr-equals,
  &.special-attr > .token.attr-value > .token.value.css {
    color: var(--mono1);
  }

  &.url {
    color: var(--hue1);
  }

  &.variable,
  &.operator,
  &.function {
    color: var(--hue2);
  }

  &.keyword {
    color: var(--hue3);
  }

  &.selector,
  &.string,
  &.char,
  &.builtin,
  &.inserted,
  &.regex,
  &.attr-value,
  &.attr-value > .token.punctuation {
    color: var(--hue4);
  }

  &.property,
  &.tag,
  &.symbol,
  &.deleted,
  &.important {
    color: var(--hue5);
  }

  &.attr-name,
  &.class-name,
  &.boolean,
  &.constant,
  &.number,
  &.atrule {
    color: var(--hue6);
  }
}

.language-css .token {
  &.property {
    color: var(--mono1);
  }

  &.function,
  &.url > .token.function {
    color: var(--hue1);
  }

  &.important,
  &.atrule .token.rule {
    color: var(--hue3);
  }

  &.url > .token.string.url {
    color: var(--hue4);
  }

  &.selector {
    color: var(--hue5);
  }
}

.language-javascript .token {
  &.operator {
    color: var(--hue3);
  }

  &.template-string > .token.interpolation > .token.interpolation-punctuation.punctuation {
    color: var(--hue5_2);
  }
}

.language-json .token {
  &.operator {
    color: var(--mono1);
  }
  &.null.keyword {
    color: var(--hue6);
  }
}

.token {
  &.bold {
    font-weight: bold;
  }

  &.italic,
  &.comment {
    font-style: italic;
  }

  &.entity {
    cursor: help;
  }

  &.namespace {
    opacity: 0.8;
  }

  &.token {
    &.tab:not(:empty):before,
    &.cr:before,
    &.lf:before,
    &.space:before {
      color: var(--mono3);
    }
  }
}

.language-markdown .token {
  &.url,
  &.url > .token.operator,
  &.url-reference.url > .token.string {
    color: var(--mono1);
  }

  &.blockquote.punctuation,
  &.hr.punctuation {
    color: var(--mono3);
    font-style: italic;
  }

  &.url > .token.url,
  &.url-reference.url {
    color: var(--hue1);
  }

  &.url > .token.content {
    color: var(--hue2);
  }

  &.italic .token.content {
    color: var(--hue3);
  }

  &.code-snippet {
    color: var(--hue4);
  }

  &.strike .token.content,
  &.strike .token.punctuation,
  &.list.punctuation,
  &.title.important > .token.punctuation {
    color: var(--hue5);
  }

  &.bold .token.content {
    color: var(--hue6);
  }
}

div.code-toolbar > .toolbar.toolbar > .toolbar-item {
  margin-right: 0.4em;

  > button,
  > a,
  > span {
    background-color: var(--bg-selection);
    color: var(--mono2);
    padding: 0.1em 0.4em;
    border-radius: 0.3em;
    &:hover,
    &:focus {
      background-color: var(--bg-selection);
      color: var(--mono1);
    }
  }
}

.line-highlight.line-highlight {
  background-color: var(--bg-line-cursor);
}

.line-highlight.line-highlight:before,
.line-highlight.line-highlight[data-end] :after {
  background-color: var(--bg-selection);
  color: var(--mono1);
  padding: 0.1em 0.6em;
  border-radius: 0.3em;
  box-shadow: 0 2px 0 0 rgba(0, 0, 0, 0.2);
}

pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows > span:hover:before {
  background-color: var(--bg-line-cursor);
}

.line-numbers.line-numbers .line-numbers-rows,
.command-line .command-line-prompt {
  border-right-color: var(--mono3);
}

.command-line .command-line-prompt > span:before,
.line-numbers .line-numbers-rows > span:before {
  color: var(--mono4);
}

.rainbow-braces .token.token.punctuation {
  &.brace-level-1,
  &.brace-level-5,
  &.brace-level-9 {
    color: var(--hue5);
  }

  &.brace-level-2,
  &.brace-level-6,
  &.brace-level-10 {
    color: var(--hue4);
  }

  &.brace-level-3,
  &.brace-level-7,
  &.brace-level-11 {
    color: var(--hue2);
  }

  &.brace-level-4,
  &.brace-level-8,
  &.brace-level-12 {
    color: var(--hue3);
  }
}

pre.diff-highlight > code .token.token {
  &.deleted:not(.prefix) {
    background-color: hsla(353, 100%, 66%, 0.15);

    &::selection,
    *::selection {
      background-color: hsla(353, 95%, 66%, 0.25);
    }
  }

  &.inserted:not(.prefix) {
    background-color: hsla(137, 100%, 55%, 0.15);

    &::selection,
    *::selection {
      background-color: hsla(135, 73%, 55%, 0.25);
    }
  }
}
